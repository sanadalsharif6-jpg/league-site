<h1>Transfers</h1>

<form method="get" style="margin-bottom:16px;">
  <label>Season:</label>
  <select name="season">
    {% for s in seasons %}
      <option value="{{ s.id }}" {% if season and s.id == season.id %}selected{% endif %}>{{ s.name }}</option>
    {% endfor %}
  </select>

  <label>Competition:</label>
  <select name="competition">
    {% for c in competitions %}
      <option value="{{ c.id }}" {% if competition and c.id == competition.id %}selected{% endif %}>
        {{ c.name }} ({{ c.get_comp_type_display }})
      </option>
    {% endfor %}
  </select>

  <button type="submit">Apply</button>
</form>

<style>
  .t-row { display:flex; align-items:center; gap:10px; padding:10px 0; border-bottom:1px solid rgba(0,0,0,.08); }
  .p-img { width:34px; height:34px; border-radius:50%; object-fit:cover; }
  .logo { width:22px; height:22px; object-fit:contain; background:transparent !important; vertical-align:middle; }
  .muted { opacity:.75; font-size:12px; }
  .team { display:inline-flex; align-items:center; gap:8px; }
</style>

{% if transfers %}
  {% for tr in transfers %}
    <div class="t-row">
      {% if tr.player.photo %}
        <img class="p-img" src="{{ tr.player.photo.url }}" alt="{{ tr.player.name }}">
      {% endif %}

      <div style="flex:1;">
        <div>
          <strong>{{ tr.player.name }}</strong>
          <span class="muted">— {{ tr.date|date:"Y-m-d" }}</span>
        </div>

        <div class="muted" style="margin-top:4px;">
          <span class="team">
            {% if tr.from_team %}
              {% if tr.from_team.logo %}
                <img class="logo" src="{{ tr.from_team.logo.url }}" alt="{{ tr.from_team.name }} logo">
              {% endif %}
              <span>{{ tr.from_team.name }}</span>
            {% else %}
              <span>—</span>
            {% endif %}
          </span>

          <span style="margin:0 10px;">→</span>

          <span class="team">
            {% if tr.to_team.logo %}
              <img class="logo" src="{{ tr.to_team.logo.url }}" alt="{{ tr.to_team.name }} logo">
            {% endif %}
            <span>{{ tr.to_team.name }}</span>
          </span>
        </div>

        {% if tr.note %}
          <div class="muted" style="margin-top:6px;">{{ tr.note }}</div>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% else %}
  <p>No transfers yet.</p>
{% endif %}
